{% extends "core/base.html" %}

{% block title %}Create Template{% endblock %}

{% block content %}
  <style>
    /* Error and field styling for the create form */
    .message.error { color: red; font-weight: bold; }
    .field-error-left { color: red; margin-right: 12px; white-space: nowrap; }
    .field-error-right { color: red; margin-left: 12px; white-space: nowrap; }
    .form-row { margin-bottom: 12px; }
    .form-row .label-strong { font-weight: bold; }
  </style>

  <h1>Create template</h1>

  {% if messages %}
    {% for message in messages %}
      <div class="message {{ message.tags }}">{{ message }}</div>
    {% endfor %}
  {% endif %}

  <form method="post" id="create-template-form">
    {% csrf_token %}
    {{ form.non_field_errors }}

    <div class="form-row" style="display:flex; align-items:center;">
      {% if form.name.errors %}
        <div class="field-error-left">{{ form.name.errors.0 }}</div>
      {% endif %}
      <div style="flex:1;">
        <div class="label-strong">{{ form.name.label_tag }}</div>
        {{ form.name }}
      </div>
    </div>

    <div class="form-row">
      <div class="label-strong">{{ form.template_type.label }}</div>
      <div>
        {{ form.template_type }}
        <button type="button" id="type-info" style="margin-left:8px;">ℹ️</button>
      </div>
      <div id="type-info-text" style="display:none; margin-top:8px; background:#f6f6f6; padding:8px; border-radius:4px;">
        /* explications a modifier */
        <p><strong>Simple</strong>: a plain table with columns like Output Plasmid, Input1, Input2.</p>
        <p><strong>Typed</strong>: each input includes a type and a value, separated by the separator character you choose (e.g., '.' or ';').</p>
      </div>
      {{ form.template_type.errors }}
    </div>

    <div class="form-row">
      <div class="label-strong">{{ form.restriction_enzyme.label_tag }}</div>
      {{ form.restriction_enzyme }}
      {{ form.restriction_enzyme.errors }}
    </div>

    <div class="form-row" id="separator-field">
      <div class="label-strong">{{ form.separator.label_tag }}</div>
      {{ form.separator }}

      {{ form.separator.errors }}
    </div>

    <div class="form-actions">
      <button type="submit">Create</button>
    </div>
  </form>

  <p><a href="{% url 'campaigns:template_list' %}">Back to template list</a></p>

  <script>
    document.addEventListener('DOMContentLoaded', function(){
      // Wire the info button
      document.getElementById('type-info').addEventListener('click', function(){
        const t = document.getElementById('type-info-text');
        t.style.display = (t.style.display === 'none') ? 'block' : 'none';
      });
    });
  </script>

{% endblock %}
