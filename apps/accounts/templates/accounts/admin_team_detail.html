{% extends "core/base.html" %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/accounts.css' %}">
{% endblock %}

{% block title %}{{ team.name }} Â· Admin{% endblock %}

{% block content %}
<div class="card">
  <div class="header-row" style="display:flex; justify-content:space-between; align-items:flex-start;">
    <div>
      <h1 class="page-title">{{ team.name }}</h1>
      <p class="muted"><strong>Owner:</strong> {{ team.owner.email }}</p>
    </div>
    <div>
      <a class="btn btn-secondary" href="{% url 'accounts:admin_team_list' %}">Back to all teams</a>
    </div>
  </div>

  <!-- Members Section -->
  <div class="section">
    <h2 class="section-title">Members ({{ members|length }})</h2>
    {% if members %}
      <div class="members-list">
        {% for user in members %}
          <div class="member-item">
            <div>
              <span class="member-email">{{ user.email }}</span>
              {% if user.id == team.owner_id %}
                <span class="badge badge-owner">Owner</span>
              {% endif %}
            </div>
          </div>
        {% endfor %}
      </div>
    {% else %}
      <p class="muted">No members in this team.</p>
    {% endif %}
  </div>

  <!-- Plasmid Collections Section -->
  <div class="section">
    <h2 class="section-title">Plasmid Collections ({{ collections|length }})</h2>
    {% if collections %}
      <ul class="resource-list">
        {% for c in collections %}
          <li>
            <span class="resource-name">{{ c.name }}</span>
            {% if c.is_public %}
              <span class="badge badge-public">Public</span>
            {% else %}
              <span class="badge badge-private">Private</span>
            {% endif %}
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p class="muted">No plasmid collections for this team.</p>
    {% endif %}
  </div>

  <!-- Plasmids Section -->
  <div class="section">
    <h2 class="section-title">Plasmids ({{ plasmids|length }})</h2>
    {% if plasmids %}
      <ul class="resource-list">
        {% for p in plasmids %}
          <li>
            <a href="{% url 'plasmids:plasmid_detail' p.id %}" class="resource-link">
              {{ p.name }}
            </a>
            {% if p.identifier %}
              <span class="muted mono">{{ p.identifier }}</span>
            {% endif %}
            {% if p.collection %}
              <span class="badge">{{ p.collection.name }}</span>
            {% endif %}
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p class="muted">No plasmids linked to this team.</p>
    {% endif %}
  </div>

  <!-- Correspondences Section -->
  <div class="section">
    <h2 class="section-title">Correspondences ({{ correspondences|length }})</h2>
    {% if correspondences %}
      <ul class="resource-list">
        {% for corr in correspondences %}
          <li>
            <a href="{% url 'correspondences:detail' corr.id %}" class="resource-link">
              {{ corr.name }}
            </a>
            <span class="muted">{{ corr.owner.email }}</span>
            {% if corr.is_public %}
              <span class="badge badge-public">Public</span>
            {% else %}
              <span class="badge badge-private">Private</span>
            {% endif %}
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p class="muted">No correspondences for this team.</p>
    {% endif %}
  </div>

  <!-- Publication Requests Section -->
  <div class="section">
    <h2 class="section-title">Publication Requests ({{ publication_requests|length }})</h2>
    {% if publication_requests %}
      <ul class="resource-list">
        {% for pub in publication_requests %}
          <li>
            <a href="{% url 'publications:admin_requests' %}" class="resource-link">
              {{ pub.target }}
            </a>
            <span class="badge">{{ pub.status }}</span>
            <span class="muted">by {{ pub.requested_by.email }}</span>
          </li>
        {% endfor %}
      </ul>
    {% else %}
      <p class="muted">No publication requests for this team.</p>
    {% endif %}
  </div>

</div>
{% endblock %}
